package com.personal.rents.activities;

import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.GoogleMap.OnMyLocationButtonClickListener;
import com.personal.rents.R;
import com.personal.rents.activities.helpers.LocationHelper;
import com.personal.rents.fragments.EnableNetworkLocationDialogFragment;
import com.personal.rents.utils.Tags;

import android.location.Location;
import android.os.Bundle;
import android.support.v7.app.ActionBarActivity;
import android.widget.Toast;

public class MapRentsActivity extends ActionBarActivity implements OnMyLocationButtonClickListener {

    public GoogleMap rentsMap;

    private LocationHelper locationHelper;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map_rents_layout);
        locationHelper = new LocationHelper(getApplicationContext());
        setUpMapIfNeeded();
    }

    @Override
    public boolean onMyLocationButtonClick() {
    Location location = locationHelper.getLastKnownLocation();
       if(location!=null) {
    	   Toast.makeText(getApplicationContext(), "My Location is not null", Toast.LENGTH_SHORT).show();
       } else {
    	   Toast.makeText(getApplicationContext(), "My location is null", Toast.LENGTH_SHORT).show();
       }
       
       return false;
    }
    
	private void setUpMapIfNeeded() {
		 if (rentsMap == null) {
	            rentsMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.rents_map))
	                    .getMap();
	            if (rentsMap != null) {
	                setUpMap();
	            }
	        }
	}
	
	private void setUpMap() {
		rentsMap.setMyLocationEnabled(true);
        rentsMap.setOnMyLocationButtonClickListener(this);
        Location location = locationHelper.getLastKnownLocation();
        if(location!=null) {
        	locationHelper.moveToLocation(location, rentsMap);
        }        
	}
}
